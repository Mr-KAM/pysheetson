<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quick Start - pysheetson</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    body { font-family: 'Inter', Arial, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); margin: 0; }
    .container { max-width: 900px; margin: 2rem auto; background: #fff; border-radius: 16px; box-shadow: 0 4px 24px rgba(0,0,0,0.08); padding: 2rem; }
    h1 { color: #2563eb; font-size: 2.2rem; margin-bottom: 0.5rem; }
    h2 { color: #1e40af; font-size: 1.5rem; margin-top: 2rem; margin-bottom: 1rem; }
    h3 { color: #3b82f6; font-size: 1.2rem; margin-top: 1.5rem; margin-bottom: 0.5rem; }
    p, li { color: #374151; font-size: 1rem; line-height: 1.7; }
    ul, ol { margin-bottom: 1.5rem; }
    .step { background: #f1f5f9; border-left: 4px solid #2563eb; padding: 1rem 1.5rem; border-radius: 8px; margin-bottom: 1.5rem; }
    .code-container { position: relative; margin: 1.5rem 0; }
    pre { background: #2d3748; color: #e2e8f0; padding: 1.2rem; border-radius: 8px; overflow-x: auto; font-size: 0.95em; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
    code { background: none; color: inherit; }
    .copy-btn { position: absolute; top: 0.7rem; right: 0.7rem; background: #2563eb; color: #fff; border: none; border-radius: 4px; padding: 0.3rem 0.7rem; cursor: pointer; font-size: 0.9em; opacity: 0.8; transition: opacity 0.2s; }
    .copy-btn:hover { opacity: 1; }
    .alert { padding: 1rem 1.5rem; border-radius: 8px; margin: 1rem 0; display: flex; align-items: flex-start; gap: 0.75rem; }
    .alert-info { background: #e0e7ff; color: #1e40af; border-left: 4px solid #2563eb; }
    .alert-warning { background: #fef3c7; color: #92400e; border-left: 4px solid #f59e0b; }
    .footer { text-align: center; color: #6b7280; margin-top: 3rem; font-size: 0.95em; }
    @media (max-width: 600px) { .container { padding: 1rem; } }
  </style>
</head>
<body>
  <div class="container">
    <h1><i class="fas fa-rocket"></i> Quick Start Guide</h1>
    <p class="alert alert-info"><i class="fas fa-info-circle"></i> Get started with pysheetson in minutes. Follow these steps to connect your Google Sheet and use it as a REST API!</p>

    <h2>1. Prepare Your Google Sheet</h2>
    <div class="step">
      <ul>
        <li>Create a Google Sheet with a header row (first row must contain column names)</li>
        <li>Use descriptive, alphanumeric column names for best compatibility</li>
      </ul>
      <div class="code-container">
        <pre><code class="language-text">| name          | country | population | founded |
|---------------|---------|------------|---------|
| San Francisco | USA     | 3314000    | 1776    |
| Tokyo         | Japan   | 37400068   | 1603    |
| Paris         | France  | 10901000   | 300     |</code></pre>
      </div>
    </div>

    <h2>2. Share Your Sheet</h2>
    <div class="step">
      <ol>
        <li>Click <strong>Share</strong> in your Google Sheet</li>
        <li>Add <code>google@sheetson.com</code> as an <strong>Editor</strong></li>
        <li>Click <strong>Send</strong></li>
      </ol>
      <p class="alert alert-warning"><i class="fas fa-exclamation-triangle"></i> Your sheet does NOT need to be public. Sharing with <code>google@sheetson.com</code> is enough.</p>
    </div>

    <h2>3. Get Your Credentials</h2>
    <div class="step">
      <ul>
        <li><strong>API Key</strong>: Get it from <a href="https://sheetson.com/dashboard" target="_blank">Sheetson Dashboard</a></li>
        <li><strong>Spreadsheet ID</strong>: Copy from your Google Sheet URL (<code>https://docs.google.com/spreadsheets/d/SPREADSHEET_ID/edit</code>)</li>
        <li><strong>Sheet Name</strong>: The tab name (case-sensitive)</li>
      </ul>
    </div>

    <h2>4. Install pysheetson</h2>
    <div class="step">
      <div class="code-container">
        <pre><code class="language-bash">pip install requests
# Optional: for DataFrame support
pip install pandas</code></pre>
      </div>
    </div>

    <h2>5. Start Coding</h2>
    <h3>Basic Usage</h3>
    <div class="code-container">
      <pre><code class="language-python">from pysheetson import SheetsonClient

client = SheetsonClient(api_key="YOUR_API_KEY", spreadsheet_id="YOUR_SPREADSHEET_ID")

# Create a new row
new_city = client.create_row("Cities", {
    "name": "London",
    "country": "UK", 
    "population": "8982000",
    "founded": "43"
})
print(f"Created row: {new_city}")

# Read all rows
cities = client.list_rows("Cities", limit=10)
print(f"Found {len(cities['results'])} cities")

# Search for specific rows
usa_cities = client.search_rows("Cities", where={"country": "USA"})
print(f"USA cities: {usa_cities}")

# Update a row
updated = client.update_row("Cities", 2, {"population": "3400000"})
print(f"Updated row: {updated}")

# Delete a row
deleted = client.delete_row("Cities", 3)
print(f"Deleted row: {deleted}")</code></pre>
    </div>

    <h3>Batch Operations</h3>
    <div class="code-container">
      <pre><code class="language-python"># Multiple operations at once
operations = [
    {"operation": "create", "data": {"name": "Berlin", "country": "Germany"}},
    {"operation": "update", "row_number": 2, "data": {"population": "3700000"}},
    {"operation": "delete", "row_number": 5}
]

result = client.batch_operations("Cities", operations)
print(f"Batch result: {result['successful_operations']} successful")</code></pre>
    </div>

    <h3>DataFrame Integration</h3>
    <div class="code-container">
      <pre><code class="language-python">import pandas as pd

df = pd.DataFrame([
    {"name": "Madrid", "country": "Spain", "population": "3223000"},
    {"name": "Rome", "country": "Italy", "population": "2873000"}
])

results = client.create_rows_from_dataframe("Cities", df)
print(f"Inserted {len(results)} batches")</code></pre>
    </div>

    <h2>Troubleshooting</h2>
    <div class="step">
      <ul>
        <li><strong>403 Forbidden</strong>: Check your API key</li>
        <li><strong>404 Not Found</strong>: Verify spreadsheet ID and sheet name</li>
        <li><strong>422 Unprocessable</strong>: Check your data format</li>
        <li><strong>No data returned</strong>: Ensure you shared the sheet with <code>google@sheetson.com</code></li>
      </ul>
    </div>

    <div class="footer">
      <p>See <a href="index.html">Full Documentation</a> &bull; <a href="https://sheetson.com/" target="_blank">Sheetson</a> &bull; <a href="https://docs.sheetson.com/" target="_blank">API Docs</a></p>
      <p>&copy; 2025 pysheetson. Built for developers.</p>
    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script>
    document.querySelectorAll('.code-container pre').forEach(pre => {
      const container = pre.parentElement;
      const button = document.createElement('button');
      button.className = 'copy-btn';
      button.innerHTML = '<i class="fas fa-copy"></i> Copy';
      button.title = 'Copy code';
      button.addEventListener('click', async () => {
        const code = pre.textContent;
        try {
          await navigator.clipboard.writeText(code);
          button.innerHTML = '<i class="fas fa-check"></i> Copied!';
          button.style.background = '#10b981';
          setTimeout(() => {
            button.innerHTML = '<i class="fas fa-copy"></i> Copy';
            button.style.background = '#2563eb';
          }, 2000);
        } catch (err) {
          console.error('Failed to copy code:', err);
        }
      });
      container.appendChild(button);
    });
  </script>
</body>
</html>
